<!DOCTYPE html>
<html lang="ko" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VSSI - Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/style.css">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* All styles moved to style.css */
    </style>
</head>

<body class="auth-body auth-page-scroll app-bg scrollbar-hide">
    <div class="auth-scroll-view">

        <!-- Upper Logo Section -->
        <div class="brand-container">
            <h1 class="brand-text">VSSI</h1>
            <p class="brand-sub">Vertiport Standards and Safety Infrastructure</p>
            <p class="brand-desc">K-UAM 상용화를 위한 버티포트 표준 및 통합운용 플랫폼</p>
        </div>

        <!-- Login Card -->
        <div class="glass-card-auth auth-card-container">

            <!-- Login Form Section -->
            <div class="auth-card-body">
                <div class="auth-card-header">
                    <h2 class="auth-card-title">로그인</h2>
                </div>

                <div class="space-y-6">
                    <div>
                        <label class="form-label">아이디</label>
                        <input type="text" id="id" placeholder="아이디를 입력해 주세요." class="form-input"
                            oninput="resetError('id')">
                        <div id="error-message" class="form-error"></div>
                    </div>

                    <div>
                        <label class="form-label">비밀번호</label>
                        <input type="password" id="pw" placeholder="비밀번호를 입력해 주세요." class="form-input"
                            oninput="resetError('pw')" onkeydown="if(event.key === 'Enter') handleLogin()">
                        <div id="error-pw" class="form-error hidden"></div>
                    </div>

                    <button onclick="handleLogin()" class="btn-primary mt-2">
                        로그인
                    </button>
                </div>

                <div class="auth-actions">
                    <a href="./CM_LG_02_01.html" class="auth-link-primary">서비스 이용 신청</a>
                    <a href="#" class="auth-link-secondary">비밀번호 초기화</a>
                </div>
            </div>

            <div class="auth-footer p-8 mt-2">
                <div class="auth-help-container">
                    <div class="auth-help-icon-wrapper">
                        <i data-lucide="help-circle" class="w-5 h-5"></i>
                    </div>
                    <div>
                        <h3 class="auth-help-title">이용에 도움이 필요하신가요?</h3>
                        <p class="auth-help-desc">
                            로그인 문제나 권한 관련 문의는 버티포트 통합 관리 시스템 관리자에게 연락해 주세요.
                        </p>
                    </div>
                </div>
                <div class="auth-cs-row">
                    <span class="auth-cs-label">CS CENTER</span>
                    <span class="auth-cs-number">000-0000-0000</span>
                </div>
            </div>

        </div>
    </div>

    <!-- Background Elements -->
    <div class="auth-bg-decoration">
        <div class="auth-bg-blob-blue"></div>
        <div class="auth-bg-blob-teal"></div>
    </div>




    <!-- Modal Component (Warning) -->
    <div id="modal-backdrop" class="modal-overlay">
        <div class="modal-dialog">
            <!-- Icon -->
            <div class="modal-icon text-yellow-500 drop-shadow-[0_0_15px_rgba(255,255,255,0.1)]">
                <i data-lucide="alert-triangle" width="64" height="64"></i>
            </div>

            <h3 id="modal-title" class="modal-title">로그인 실패</h3>
            <p id="modal-desc" class="modal-desc"></p>

            <!-- Buttons -->
            <div class="modal-btn-group">
                <button onclick="closeModal()"
                    class="w-full bg-yellow-600/80 hover:bg-yellow-500/80 border border-yellow-500/30 text-white py-3 font-bold text-sm">확인</button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        let failCount = 0;

        function resetError(id) {
            const input = document.getElementById(id);
            const errorDiv = document.getElementById('error-' + id);

            // Reset border (using class)
            input.classList.remove('error');

            // Hide error text
            errorDiv.innerText = '';
            errorDiv.classList.add('hidden');
        }

        function setError(id, msg) {
            const input = document.getElementById(id);
            const errorDiv = document.getElementById('error-' + id);

            // Set border red
            input.classList.add('error');

            // Show error text
            errorDiv.innerText = msg;
            errorDiv.classList.remove('hidden');
        }

        function showModal(title, msg) {
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-desc').innerText = msg;
            document.getElementById('modal-backdrop').classList.add('active');
        }

        function closeModal() {
            document.getElementById('modal-backdrop').classList.remove('active');
        }

        function handleLogin() {
            const id = document.getElementById('id').value.trim();
            const pw = document.getElementById('pw').value.trim();
            let hasError = false;

            if (!id) {
                setError('id', '아이디를 입력해 주세요.');
                hasError = true;
            }
            if (!pw) {
                setError('pw', '비밀번호를 입력해 주세요.');
                hasError = true;
            }

            if (hasError) return;

            // Mock Login Logic
            // Spec: "Fail 5 times -> Lock" logic.
            // Let's pretend 'admin/1234' is correct for demo purposes, or just fail everything else to show modal.

            // For this task, user usually wants it "working" as a demo.
            // But they asked for specific fail modals.

            // Hardcoded "Success"
            const VALID_USER = 'admin';
            const VALID_PW = '1234'; // Or just let any non-empty pass if we want easy demo?
            // Actually, usually users want to just "Log in". 
            // BUT the Prompt specifically asked for "Login Fail Modal" logic implementation as per the image.
            // So I should implement a "fail" condition to demonstrate it.

            // Let's say: if user enters 'fail', trigger fail. If normal, success.
            // OR: simpler, make 'admin' success, everything else fail to show the feature.

            if (id === 'admin' && pw === '1234') {
                // Success
                window.location.href = 'SAM_AS_10_01.html'; // Or COM_IT_01_01 if that existed
            } else {
                // Fail
                failCount++;
                if (failCount >= 5) {
                    showModal('로그인 실패', '아이디 또는 비밀번호를 5회 연속 잘못 입력하여 로그인이 제한되었습니다.');
                } else {
                    showModal('로그인 실패', `아이디와 비밀번호를 확인해 주세요. 5회 연속 실패 시 로그인이 제한됩니다.\n(현재 실패 횟수: ${failCount}회)`);
                }
            }
        }
    </script>
</body>

</html>